Вариант 1 
Обозначим longitude долготу точки на поверхности планеты, latitude - ее 
широту. Заметьте, во входных данных широта и долгота даны в градусах, а в 
Турбо Паскале все тригонометрические функции работают со значениями в 
радианах. Поэтому сразу после чтения широты и долготы нужно преобразовать 
их в радианы (разделить на 180 и умножить на pi). 
Переведем сферические координаты в трехмерные декартовы: 
X = R cos (latitude) cos (longitude) i Y = R cos {latitude)sin 
{longitude) i Z = R sin {latitude) • 
Найдем расстояние между точками по прямой: 
D = yj{Xx -X2f + (У, - Y2f + (Z, - Z2f . 
Рассмотрим треугольник, образованный двумя заданными точками и центром 
планеты. Две его стороны равны R и одна D. Если найти а - угол при 
вершине, являющейся центром планеты, то минимальный путь по поверхности 
планеты легко найти по формуле aR (а в радианах). 
Найдем угол а в этом треугольнике. Опустим высоту на сторону длиной D. 
Получатся два равных прямоугольных треугольника. В прямоугольном 
треугольнике гипотенуза будет равна R, а сторона, противолежащая углу 
а/2, будет равна D/2. Следовательно, а/2 = arcsin((Z)/2)//?). 
В Турбо Паскале нет функций arcsin и arccos, есть только arctan. 
Воспользуемся ею. Если известна гипотенуза и один из катетов 
прямоугольного треугольника, то 
найти второй катет ничего не стоит по теореме Пифагора: Н = ^R2 -{D/lf . 
После чего угол находится через арктангенс: а/2 = arctg((D/2)/Н). 
192 
Тренировка 8 
Детали реализации: 
• При использовании в этой задаче типа real требуемая точность достигнута 
не будет - следует применять double или extended. 
• Тип extended позволяет представить вещественное значенрте наиболее 
точно. Однако для него более, чем для других вещественных типов, 
характерны ошибки округления. Пусть, например, точки лежат на 
противоположных сторонах планеты. По формулам должно выполняться D = 2R. 
В реальных вычислениях D может оказаться чуть-чуть больше 2R. Это "чуть- 
чуть" проявит себя при вычислении Я: возникнет ошибка времени выполнения 
- вычисление корня из отрицательного числа. Чтобы этого избежать, перед 
вычислением Я нужно написать: 
if d > 2 * г then 
d := 2 * г: 
Если не позаботиться об этом явно, при вычислении по формуле а = = 
2arctg((D/2)/#) может произойти деление на 0. Случай Я = 0 нужно выделить 
отдельно, в этом случае точки лежат на противоположных сторонах планеты и 
а = тс. 
Вариант 2 
Решение предложил Никита Рыбак. 
Найдем трехмерные декартовы координаты точек на поверхности сферы, как в 
варианте 1. 
Центр сферы является центром системы координат, поэтому координаты точек 
являются также координатами векторов, направленных из центра сферы в 
заданные точки. 
Найдем косинус угла между векторами с помощью скалярного произведения 
век- 
XtXo+KFo+ZZo торов: cos а = -"----------. 
Теперь нужно бы найти арккосинус, по в Турбо Паскале нет функции arccos, 
есть только arctan. Найдем синус угла из основного тригонометрического 
тождества: sin2 а + cos2 а = 1. Получается формула sin а = VI - cos2 а. 
Синус неотрицательный, потому что нас интересует угол из интервала [0; 
тс]. 
Тангенс находится по определению: tg а = -1 -. От этой величины уже можно 
взять 
cos а 
арктангенс, только нужно всегда помнить, что функция arctan возвращает 
значе- 
/ _ _\ тс тс 
ние из интервала 
2' 2 
, а нам в этой задаче нужно значение из интервала [0; тс]. 
Поэтому, если угол лежит во второй четверти (cos а < 0), то к углу, 
полученному с помощью arctan, нужно добавить тс. 
Нельзя для определения того, добавлять или не добавлять тс к результату 
arctan, использовать знак самого результата arctan - если угол близок к 0 
или к тс, значе- 
Решение задачи 8 Е. Путь коня 
193 
ние arctan становится равным 0, и различить эти два случая по знаку 
результата 
арктангенса невозможно. 
Детали реализации: 
• Как и в варианте 1, точности типа real не хватит. 
• Как и в варианте 1, следует иметь в виду ошибки округления. Например, 
полученный с помощью скалярного произведения косинус может оказаться чуть 
больше 1 или чуть меньше -1. При нахождении синуса с помощью такого 
косинуса возникнет ошибка вычисления корня из отрицательного числа. 
Значит,* если значение косинуса больше 1, нужно его сделать равным 1, 
если меньше -1 - равным -1. 
• Как и в варианте 1, следует перед делением убедиться в том, что 
делитель не нулевой. Например, при нахождении тангенса по синусу и 
косинусу нужно отдельно рассмотреть случай cos а = 0 - в этом случае угол 
равен тс/2. 
Вариант 3 
Решение предложил Никита Рыбак. 
Найдем трехмерные декартовы координаты точек на поверхности сферы, как в 
варианте 1. 
Найдем косинус угла между векторами, как в варианте 2. 
В этом решении используется тот факт, что функция arctan возвращает угол 
из интервала - -; - . Если косинус угла получился отрицательный, то угол 
принад- 
. Используем равенство cos а = -cos(tc - а). То есть если ко- 
лежит интервалу 
тс 2 ;ТС 
синус получился отрицательным, нужно запомнить его знак в отдельную 
переменную и взять его по модулю. А когда в результате вычислений 
получится угол из 
интервала 
, вспомнить, был ли минус, и если был, то настоящее значение угла 
°; 2 
получить так:	' 
alpha := pi - alpha; 
Детали реализации - см. вариант 2: опасности в этих способах решения 
одинаковы. 
